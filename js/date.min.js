function SetDate(t,e){var n=new Date,a=n.getFullYear()-50,o=n.getFullYear()+20;cal=null==cal?new Calendar(a,o,0,e):cal.dateFormatStyle==e?cal:new Calendar(a,o,0,e),cal.show(t)}function Calendar(t,e,n,a){this.beginYear=1990,this.endYear=2010,this.lang=0,this.dateFormatStyle="yyyy-MM-dd",null!=t&&null!=e&&(this.beginYear=t,this.endYear=e),null!=n&&(this.lang=n),null!=a&&(this.dateFormatStyle=a),this.dateControl=null,this.panel=this.getElementById("calendarPanel"),this.container=this.getElementById("ContainerPanel"),this.form=null,this.date=new Date,this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.colors={cur_word:"#FFFFFF",cur_bg:"#83A6F4",sel_bg:"#FFCCCC",sun_word:"#FF0000",sat_word:"#0000FF",td_word_light:"#333333",td_word_dark:"#CCCCCC",td_bg_out:"#EFEFEF",td_bg_over:"#FFCC00",tr_word:"#FFFFFF",tr_bg:"#666666",input_border:"#CCCCCC",input_bg:"#EFEFEF"},this.draw(),this.bindYear(),this.bindMonth(),this.changeSelect(),this.bindData()}var cal,isFocus=!1;String.prototype.toDate=function(style){var y=this.substring(style.indexOf("y"),style.lastIndexOf("y")+1),m=this.substring(style.indexOf("M"),style.lastIndexOf("M")+1),d=this.substring(style.indexOf("d"),style.lastIndexOf("d")+1),h=this.substring(style.indexOf("h"),style.lastIndexOf("h")+1),i=this.substring(style.indexOf("m"),style.lastIndexOf("m")+1),s=this.substring(style.indexOf("s"),style.lastIndexOf("s")+1),dt;return isNaN(y)&&(y=(new Date).getFullYear()),isNaN(m)&&(m=(new Date).getMonth()),isNaN(d)&&(d=(new Date).getDate()),isNaN(h)&&(h=(new Date).getHours()),isNaN(i)&&(i=(new Date).getMinutes()),isNaN(s)&&(s=(new Date).getSeconds()),eval("dt = new Date('"+y+"', '"+(m-1)+"','"+d+"','"+h+"','"+i+"','"+s+"')"),dt},Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"天一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[n]:("00"+e[n]).substr((""+e[n]).length)));return t},Calendar.language={year:[[""],[""]],months:[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]],weeks:[["日","一","二","三","四","五","六"],["SUN","MON","TUR","WED","THU","FRI","SAT"]],abort:[["时间"],["TIME"]],clear:[["清空"],["CLS"]],today:[["今天"],["TODAY"]],close:[["关闭"],["CLOSE"]]},Calendar.prototype.draw=function(){calendar=this;var mvAry=[];mvAry[mvAry.length]=' <div name="calendarForm" style="margin: 0px;">',mvAry[mvAry.length]='    <table width="100%" border="0" cellpadding="0" cellspacing="1">',mvAry[mvAry.length]="      <tr>",mvAry[mvAry.length]='        <th align="left" width="1%"><input style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:16px;height:20px;" name="prevMonth" type="button" id="prevMonth" value="<" /></th>',mvAry[mvAry.length]='        <th align="center" width="98%" nowrap="nowrap"><select name="calendarYear" id="calendarYear" style="font-size:12px;"></select><select name="calendarMonth" id="calendarMonth" style="font-size:12px;"></select></th>',mvAry[mvAry.length]='        <th align="right" width="1%"><input style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:16px;height:20px;" name="nextMonth" type="button" id="nextMonth" value=">" /></th>',mvAry[mvAry.length]="      </tr>",mvAry[mvAry.length]="    </table>",mvAry[mvAry.length]='    <table id="calendarTable" width="100%" style="border:0px solid #CCCCCC;background-color:#FFFFFF" border="0" cellpadding="3" cellspacing="1">',mvAry[mvAry.length]="      <tr>";for(var i=0;i<7;i++)mvAry[mvAry.length]='      <th style="font-weight:normal;background-color:'+calendar.colors.tr_bg+";color:"+calendar.colors.tr_word+';">'+Calendar.language.weeks[this.lang][i]+"</th>";mvAry[mvAry.length]="      </tr>";for(var i=0;i<6;i++){mvAry[mvAry.length]='    <tr align="center">';for(var j=0;j<7;j++)mvAry[mvAry.length]=0==j?' <td style="cursor:default;color:'+calendar.colors.sun_word+';"></td>':6==j?' <td style="cursor:default;color:'+calendar.colors.sat_word+';"></td>':' <td style="cursor:default;"></td>';mvAry[mvAry.length]="    </tr>"}mvAry[mvAry.length]='      <tr align="center" style="font-size:12px;">',mvAry[mvAry.length]='        <td name="abort" id="abort" colspan="1" style="cursor:default;">'+Calendar.language.abort[this.lang]+"</td>",mvAry[mvAry.length]='        <td colspan="6"><select name="calendarHour" id="calendarHour"></select>',mvAry[mvAry.length]=':<select name="calendarMinute" id="calendarMinute"></select>',mvAry[mvAry.length]=':<select name="calendarSecond" id="calendarSecond"></select>',mvAry[mvAry.length]="      </td></tr>",mvAry[mvAry.length]='      <tr style="background-color:'+calendar.colors.input_bg+';">',mvAry[mvAry.length]='        <th colspan="2"><input name="calendarClear" type="button" id="calendarClear" value="'+Calendar.language.clear[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:100%;height:20px;font-size:12px;"/></th>',mvAry[mvAry.length]='        <th colspan="3"><input name="calendarToday" type="button" id="calendarToday" value="'+Calendar.language.today[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:100%;height:20px;font-size:12px;"/></th>',mvAry[mvAry.length]='        <th colspan="2"><input name="calendarClose" type="button" id="calendarClose" value="'+Calendar.language.close[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:100%;height:20px;font-size:12px;"/></th>',mvAry[mvAry.length]="      </tr>",mvAry[mvAry.length]="    </table>",mvAry[mvAry.length]=" </div>",this.panel.innerHTML=mvAry.join("");var obj=this.getElementById("prevMonth");with(obj.onclick=function(){calendar.goPrevMonth(calendar)},obj.onblur=function(){calendar.onblur()},this.prevMonth=obj,obj=this.getElementById("nextMonth"),obj.onclick=function(){calendar.goNextMonth(calendar)},obj.onblur=function(){calendar.onblur()},this.nextMonth=obj,obj=this.getElementById("calendarClear"),obj.onclick=function(){calendar.dateControl.value="",calendar.hide()},this.calendarClear=obj,obj=this.getElementById("calendarClose"),obj.onclick=function(){calendar.hide()},this.calendarClose=obj,obj=this.getElementById("calendarYear"),obj.onchange=function(){calendar.update(calendar)},obj.onblur=function(){calendar.onblur()},this.calendarYear=obj,obj=this.getElementById("calendarMonth"),obj)onchange=function(){calendar.update(calendar)},onblur=function(){calendar.onblur()};with(this.calendarMonth=obj,obj=this.getElementById("calendarHour"),obj){length=0;for(var i=0;i<24;i++)options[length]=i<10?new Option("0"+i,"0"+i):new Option(i,i)}with(this.calendarHour=obj,obj=this.getElementById("calendarMinute"),obj){length=0;for(var i=0;i<60;i++)options[length]=i<10?new Option("0"+i,"0"+i):new Option(i,i)}with(this.calendarMinute=obj,obj=this.getElementById("calendarSecond"),obj){length=0;for(var i=0;i<60;i++)options[length]=i<10?new Option("0"+i,"0"+i):new Option(i,i)}this.calendarSecond=obj,obj=this.getElementById("calendarToday"),obj.onclick=function(){var t=new Date;calendar.date=t,calendar.year=t.getFullYear(),calendar.month=t.getMonth(),calendar.changeSelect(),calendar.bindData(),calendar.dateControl.value=t.format(calendar.dateFormatStyle),calendar.hide()},this.calendarToday=obj},Calendar.prototype.bindYear=function(){var t=this.calendarYear;t.length=0;for(var e=this.beginYear;e<=this.endYear;e++)t.options[t.length]=new Option(e+Calendar.language.year[this.lang],e)},Calendar.prototype.bindMonth=function(){var t=this.calendarMonth;t.length=0;for(var e=0;e<12;e++)t.options[t.length]=new Option(Calendar.language.months[this.lang][e],e)},Calendar.prototype.getHour=function(){return this.calendarHour.options[this.calendarHour.selectedIndex].value},Calendar.prototype.getMinute=function(){return this.calendarMinute.options[this.calendarMinute.selectedIndex].value},Calendar.prototype.getSecond=function(){return this.calendarSecond.options[this.calendarSecond.selectedIndex].value},Calendar.prototype.goPrevMonth=function(t){this.year==this.beginYear&&0==this.month||(this.month--,-1==this.month&&(this.year--,this.month=11),this.date=new Date(this.year,this.month,1,this.getHour(),this.getMinute(),this.getSecond()),this.changeSelect(),this.bindData())},Calendar.prototype.goNextMonth=function(t){this.year==this.endYear&&11==this.month||(this.month++,12==this.month&&(this.year++,this.month=0),this.date=new Date(this.year,this.month,1,this.getHour(),this.getMinute(),this.getSecond()),this.changeSelect(),this.bindData())},Calendar.prototype.changeSelect=function(){for(var t=this.calendarYear,e=this.calendarMonth,n=this.calendarHour,a=this.calendarMinute,o=this.calendarSecond,r=0;r<t.length;r++)if(t.options[r].value==this.date.getFullYear()){t[r].selected=!0;break}for(r=0;r<e.length;r++)if(e.options[r].value==this.date.getMonth()){e[r].selected=!0;break}for(r=0;r<n.length;r++)if(n.options[r].value==this.date.getHours()){n[r].selected=!0;break}for(r=0;r<a.length;r++)if(a.options[r].value==this.date.getMinutes()){a[r].selected=!0;break}for(r=0;r<o.length;r++)if(o.options[r].value==this.date.getSeconds()){o[r].selected=!0;break}},Calendar.prototype.update=function(t){this.year=t.calendarYear.options[t.calendarYear.selectedIndex].value,this.month=t.calendarMonth.options[t.calendarMonth.selectedIndex].value,this.date=new Date(this.year,this.month,1,this.getHour(),this.getMinute(),this.getSecond()),this.changeSelect(),this.bindData()},Calendar.prototype.bindData=function(){for(var t=this,e=this.getMonthViewArray(this.date.getFullYear(),this.date.getMonth()),n=this.getElementById("calendarTable").getElementsByTagName("td"),a=0;a<n.length&&(n[a].style.backgroundColor=t.colors.td_bg_out,n[a].onclick=function(){},n[a].onmouseover=function(){},n[a].onmouseout=function(){},!(a>e.length-1));a++)n[a].innerHTML=e[a]," "!=e[a]&&(n[a].onclick=function(){null!=t.dateControl&&(t.dateControl.value=new Date(t.date.getFullYear(),t.date.getMonth(),this.innerHTML,t.getHour(),t.getMinute(),t.getSecond()).format(t.dateFormatStyle)),t.hide()},n[a].onmouseover=function(){this.style.backgroundColor=t.colors.td_bg_over},n[a].onmouseout=function(){this.style.backgroundColor=t.colors.td_bg_out},(new Date).format("yyyy-MM-dd")==new Date(t.date.getFullYear(),t.date.getMonth(),e[a]).format("yyyy-MM-dd")&&(n[a].style.backgroundColor=t.colors.cur_bg,n[a].onmouseover=function(){this.style.backgroundColor=t.colors.td_bg_over},n[a].onmouseout=function(){this.style.backgroundColor=t.colors.cur_bg}),null!=t.dateControl&&t.dateControl.value==new Date(t.date.getFullYear(),t.date.getMonth(),e[a],t.getHour(),t.getMinute(),t.getSecond()).format(t.dateFormatStyle)&&(n[a].style.backgroundColor=t.colors.sel_bg,n[a].onmouseover=function(){this.style.backgroundColor=t.colors.td_bg_over},n[a].onmouseout=function(){this.style.backgroundColor=t.colors.sel_bg}))},Calendar.prototype.getMonthViewArray=function(t,e){for(var n=[],a=new Date(t,e,1).getDay(),o=new Date(t,e+1,0).getDate(),r=0;r<42;r++)n[r]=" ";for(r=0;r<o;r++)n[r+a]=r+1;return n},Calendar.prototype.getElementById=function(id){if("string"!=typeof id||""==id)return null;if(document.getElementById)return document.getElementById(id);if(document.all)return document.all(id);try{return eval(id)}catch(t){return null}},Calendar.prototype.getElementsByTagName=function(t,e){return document.getElementsByTagName?document.getElementsByTagName(e):document.all?document.all.tags(e):void 0},Calendar.prototype.getAbsPoint=function(t){for(var e=t.offsetLeft,n=t.offsetTop;t=t.offsetParent;)e+=t.offsetLeft,n+=t.offsetTop;return{x:e,y:n}},Calendar.prototype.show=function(t,e){if(null==t)throw new Error("arguments[0] is necessary");this.dateControl=t,this.date=t.value.length>0?new Date(t.value.toDate(this.dateFormatStyle)):new Date,this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.changeSelect(),this.bindData(),null==e&&(e=t);var n=this.getAbsPoint(e);this.panel.style.left=n.x-25+"px",this.panel.style.top=n.y+t.offsetHeight+"px",this.panel.style.display="",this.container.style.display="",t.onblur=function(){calendar.onblur()},this.container.onmouseover=function(){isFocus=!0},this.container.onmouseout=function(){isFocus=!1}},Calendar.prototype.hide=function(){this.panel.style.display="none",this.container.style.display="none",isFocus=!1},Calendar.prototype.onblur=function(){isFocus||this.hide()},document.write('<div id="ContainerPanel" style="display:none;"><div id="calendarPanel" style="position: absolute;display: none;z-index: 9999;'),document.write('background-color: #FFFFFF;border: 1px solid #CCCCCC;width:175px;font-size:12px;margin-left:25px;"></div>'),document.write("</div>");